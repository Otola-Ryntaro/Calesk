# チケット019: プレビュー→適用ワークフロー

## 概要

現在、テーマを選択すると即座に壁紙が更新されるが、
「まずプレビューで確認 → 明示的に適用」という2ステップのワークフローに変更する。

## 要件

### 現状の問題
- テーマComboBox変更 → `set_theme()` → `update_wallpaper()` が即座に実行される
- ユーザーが意図せず壁紙が変更されてしまう
- プレビューを見てから適用するかどうか判断したい

### 変更後のフロー
1. テーマをComboBoxで選択 → **プレビュー画像のみ生成・表示**（壁紙は変更しない）
2. ユーザーが「このテーマを壁紙に適用」ボタンをクリック → 壁紙を実際に適用

### UI変更
- 「今すぐ更新」ボタン → **「壁紙に適用」ボタンに変更**
- テーマ選択時は**プレビューのみ**自動生成
- 適用前は「壁紙に適用」ボタンがアクティブになる

## タスク

### ViewModel層
- [x] `MainViewModel.preview_theme()` メソッド追加（プレビュー画像のみ生成）
- [x] `MainViewModel.apply_wallpaper()` メソッド追加（壁紙を実際に適用）
- [x] `set_theme()` の動作変更：壁紙更新を自動で呼ばない
- [x] `preview_ready` シグナル追加（プレビュー画像パスを通知）

### View層
- [x] テーマ変更時にプレビューのみ表示する処理
- [x] 「壁紙に適用」ボタン追加
- [x] ボタンの有効/無効状態管理

### テスト
- [x] `MainViewModel.preview_theme()` のテスト
- [x] `MainViewModel.apply_wallpaper()` のテスト
- [x] テーマ変更時に壁紙が即適用されないことのテスト
- [x] UIボタン連携のテスト

## 変更ファイル

- `src/viewmodels/main_viewmodel.py` - プレビュー/適用メソッド追加
- `src/ui/main_window.py` - ボタンUI変更、ワークフロー変更
- `tests/test_preview_apply.py` - 新規テスト

## 優先度: HIGH
## 工数: 小（2-3時間）
